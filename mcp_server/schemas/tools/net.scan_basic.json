{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://schemas.darkmatter.security/tools/net.scan_basic.json",
  "title": "Nmap Basic Network Scanner",
  "description": "JSON Schema for nmap basic network scanning tool with safety constraints and validation based on official nmap documentation",
  "type": "object",
  "properties": {
    "target": {
      "type": "string",
      "title": "Target",
      "description": "Target specification: IP address, hostname, or CIDR range to scan",
      "pattern": "^[0-9A-Za-z.:/_-]+$",
      "examples": [
        "192.168.1.1",
        "example.com", 
        "10.0.0.0/24",
        "scanme.nmap.org",
        "192.168.1.1-20"
      ],
      "minLength": 1,
      "maxLength": 253
    },
    "ports": {
      "type": "string", 
      "title": "Port Range",
      "description": "Port specification (comma-separated ports or ranges, e.g., '80,443' or '1-1000')",
      "pattern": "^[0-9,\\-\\s]*$",
      "examples": [
        "80,443",
        "1-1000", 
        "22,80,443,8080",
        "80-90,443,8080-8090",
        "1-65535"
      ],
      "maxLength": 100
    },
    "fast": {
      "type": "boolean",
      "title": "Fast Scan Mode",
      "description": "Enable fast scan mode (-F flag): scans fewer ports for faster results",
      "default": true
    },
    "scan_type": {
      "type": "string",
      "title": "Scan Type",
      "description": "Type of nmap scan to perform",
      "enum": ["tcp_connect", "tcp_syn", "udp", "ping"],
      "default": "tcp_syn"
    },
    "timing_template": {
      "type": "integer",
      "title": "Timing Template",
      "description": "Nmap timing template (0=paranoid, 1=sneaky, 2=polite, 3=normal, 4=aggressive, 5=insane)",
      "minimum": 0,
      "maximum": 5,
      "default": 2
    },
    "service_detection": {
      "type": "boolean",
      "title": "Service Detection",
      "description": "Enable service/version detection (-sV flag)",
      "default": true
    },
    "os_detection": {
      "type": "boolean", 
      "title": "OS Detection",
      "description": "Enable OS detection (-O flag) - requires elevated privileges",
      "default": false
    },
    "host_timeout": {
      "type": "string",
      "title": "Host Timeout", 
      "description": "Timeout for each host (e.g., '2m', '30s', '1h')",
      "pattern": "^\\d+[smh]?$",
      "default": "2m",
      "examples": ["30s", "2m", "5m", "1h"]
    },
    "max_retries": {
      "type": "integer",
      "title": "Maximum Retries",
      "description": "Maximum number of port scan probe retransmissions",
      "minimum": 0,
      "maximum": 10,
      "default": 3
    },
    "additional_flags": {
      "type": "array",
      "title": "Additional Flags",
      "description": "Additional nmap flags (validated for safety)",
      "items": {
        "type": "string",
        "pattern": "^--?[a-zA-Z0-9-]+$"
      },
      "maxItems": 10,
      "uniqueItems": true,
      "examples": [
        ["--open"],
        ["--reason", "--packet-trace"],
        ["--script=safe"]
      ]
    }
  },
  "required": ["target"],
  "additionalProperties": false,
  "examples": [
    {
      "target": "192.168.1.1",
      "fast": true
    },
    {
      "target": "10.0.0.0/24", 
      "ports": "22,80,443",
      "service_detection": true,
      "timing_template": 3
    },
    {
      "target": "scanme.nmap.org",
      "ports": "1-1000",
      "scan_type": "tcp_connect",
      "host_timeout": "5m",
      "additional_flags": ["--open", "--reason"]
    }
  ],
  "definitions": {
    "target_types": {
      "description": "Supported target specification formats",
      "examples": [
        "Single IP: 192.168.1.1",
        "Hostname: example.com", 
        "CIDR range: 192.168.1.0/24",
        "IP range: 192.168.1.1-20",
        "Multiple targets: 192.168.1.1,192.168.1.5"
      ]
    },
    "port_formats": {
      "description": "Supported port specification formats",
      "examples": [
        "Single port: 80",
        "Multiple ports: 80,443,8080",
        "Port range: 1-1000", 
        "Mixed: 22,80-90,443,8000-9000"
      ]
    }
  },
  "security": {
    "note": "This schema enforces safety constraints to prevent malicious usage",
    "restrictions": [
      "Target pattern validation prevents command injection",
      "Port specification is limited to numeric ranges",
      "Additional flags are validated against safe patterns",
      "Timing templates are restricted to prevent aggressive scanning",
      "Default timeouts prevent resource exhaustion"
    ]
  }
}